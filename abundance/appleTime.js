
orchardsData = {
  "type": "FeatureCollection",
  "features": [
 {
   "type": "Feature",
   "id":0,
   "geometry": {
      "type": "Point",
      "coordinates":  [ -119.6410934,46.28025735 ]
   },
   "properties": {
   "id":0,
   "orchardName":"O'Brien Farms",
   "City":"Prosser",
   "State":"Washington",
   "Breeds":['Fuji', 'Gala', 'Granny Smith', 'Red Delicious', 'Pink Lady', 'Koru', 'Cosmic Crisp'],
   "Address":"O'Brien, 45402 N O'Brien Rd, Prosser, WA 99350",
   "GMapsLink":"https://www.google.com/maps/place/O'Brien+Farms+LLC/@46.2813099,-119.6690054,13z/data=!4m6!3m5!1s0x549813635d5028eb:0x7adfb15020ca9444!8m2!3d46.280252!4d-119.641164!16s%2Fg%2F1tdwpth0?entry=ttu",
   "PhoneNumber":"(509) 973 2700",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":1,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -120.617528,46.62848641 ]
   },
   "properties": {
   "id":1,
   "orchardName":"Lopez Orchards",
   "City":"Yakima",
   "State":"Washington",
   "Breeds":['Red Delicious', 'Golden Delicious', 'Gala', 'Honeycrisp', 'Cosmic Crisp'],
   "Address":"121 Ehler Rd, Yakima, WA 98908",
   "GMapsLink":"https://www.google.com/maps/place/Lopez+Orchard/@46.6262081,-120.6284517,15z/data=!4m6!3m5!1s0x54976090b697be21:0x1be8314a12a72567!8m2!3d46.6265404!4d-120.6236212!16s%2Fg%2F1tfbhfs4?entry=ttu",
   "PhoneNumber":"(509) 966 4697",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":2,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -119.7683486,47.26169588 ]
   },
   "properties": {
   "id":2,
   "orchardName":"MM Orchards",
   "City":"Quincy",
   "State":"Washington",
   "Breeds":['Gala', 'KIKU', 'Ambrosia', 'Fuji', 'Honeycrisp', 'Red Delicious', 'Cosmic Crisp'],
   "Address":"12029 Adams Rd N, Quincy, WA 98848",
   "GMapsLink":"https://www.google.com/maps/place/Double+M+Orchards/@47.2654592,-119.8048845,12.12z/data=!4m6!3m5!1s0x5499638b437d5e3d:0xa2f65f0ba3c66014!8m2!3d47.2616831!4d-119.7684349!16s%2Fg%2F11cjj9xqb9?entry=ttu",
   "PhoneNumber":"(509) 787 9082",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":3,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -120.2168894,47.40253871 ]
   },
   "properties": {
   "id":3,
   "orchardName":"CMI Orchards",
   "City":"Wenatchee",
   "State":"Washington",
   "Breeds":['KIKU', 'Kanzi', 'Smitten', 'Honeycrisp', 'Gala'],
   "Address":"2525 Euclid Ave, Wenatchee, WA 98801",
   "GMapsLink":"https://www.google.com/maps/place/CMI+Orchards+LLC/@47.4607933,-120.3370753,13.95z/data=!4m6!3m5!1s0x549bcba014ceaaab:0x156e3c8e570a4610!8m2!3d47.4633357!4d-120.3240565!16s%2Fg%2F11hy9pb_dl?entry=ttu",
   "PhoneNumber":"(509) 663 1955",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":4,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -120.2112153,47.64894824 ]
   },
   "properties": {
   "id":4,
   "orchardName":"Orondo Orchards",
   "City":"Orondo",
   "State":"Washington",
   "Breeds":['Gala', 'Honeycrisp', 'Fuji', 'Envy', 'Sugarbee'],
   "Address":"21466 State Highway 97 Orondo, WA 98843",
   "GMapsLink":"",
   "PhoneNumber":"(509) 888 8106",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":5,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -120.1847896,47.91591125 ]
   },
   "properties": {
   "id":5,
   "orchardName":"Carleton Orchards",
   "City":"Manson",
   "State":"Washington",
   "Breeds":['Golden Delicious', 'Granny Smith', 'Fuji', 'Honeycrisp', 'Pink Lady', 'Cosmic Crisp', 'Gala'],
   "Address":"630 Sunnyside Blvd SE, Lake Stevens, WA 98258",
   "GMapsLink":"https://www.google.com/maps/place/Carleton+Farms/@47.9846278,-122.1603424,12.88z/data=!4m6!3m5!1s0x549aab0ee922cfdb:0xe133e23e55e8dc27!8m2!3d47.9900135!4d-122.134392!16s%2Fg%2F1tncsm5y?entry=ttu",
   "PhoneNumber":"(425) 343 4963",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":6,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -119.7881616,48.10160403 ]
   },
   "properties": {
   "id":6,
   "orchardName":"Schoenwald Orchards",
   "City":"Brewster",
   "State":"Washington",
   "Breeds":['Cosmic Crisp', 'Pink Lady', 'Rockit', 'Sugarbee', 'Gala', 'Golden Delicious', 'Red Delicious', 'Granny Smith', 'Honeycrisp'],
   "Address":"",
   "GMapsLink":"",
   "PhoneNumber":"",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":7,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -123.005628,44.011659 ]
   },
   "properties": {
   "id":7,
   "orchardName":"ME & Moore Farm",
   "City":"Eugene",
   "State":"Oregon",
   "Breeds":['Gravenstein', 'Akane', 'Gala', 'Honeycrisp', 'Jonagold', 'Empire', 'Rome Beauty', 'Golden Delicious', 'Spitzenberg', 'Braeburn', 'Fuji'],
   "Address":"34137 Seavey Loop Rd, Eugene, OR 97405",
   "GMapsLink":"https://www.google.com/maps/place/ME+%26+Moore+and+Evenfall/@44.0117443,-123.0103962,15z/data=!4m6!3m5!1s0x54c0e000e73d521b:0xa1e25b4b59fb98f1!8m2!3d44.0119277!4d-123.0055971!16s%2Fg%2F1ptxq5jg_?authuser=0&entry=ttu",
   "PhoneNumber":"(541) 741 4790",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":8,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.734979,42.247242 ]
   },
   "properties": {
   "id":8,
   "orchardName":"Valley View Orchards",
   "City":"Ashland",
   "State":"Oregon",
   "Breeds":['Gravenstein', 'New Town Pippin'],
   "Address":"1800 N Valley View Rd, Ashland, OR 97520",
   "GMapsLink":"https://www.google.com/maps/place/Valley+View+Orchard/@42.2454641,-122.7434766,14.31z/data=!3m1!5s0x54cf73c811fa8591:0x18eedc7c5ce33717!4m6!3m5!1s0x54cf73b8048c4f2d:0x52fe5b0e9c99897b!8m2!3d42.2475203!4d-122.735097!16s%2Fg%2F1tjy16t1?entry=ttu",
   "PhoneNumber":"(541) 488 2840",
   "Website":"https://valleyvieworchardorganics.com/"
   }
 },
 {
   "type": "Feature",
   "id":9,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.875726,45.347355 ]
   },
   "properties": {
   "id":9,
   "orchardName":"Sherwood Orchards",
   "City":"Sherwood",
   "State":"Oregon",
   "Breeds":[],
   "Address":"23995 SW Pacific Hwy, Sherwood, OR 97140",
   "GMapsLink":"https://www.google.com/maps/place/Sherwood+Orchards/@45.3460511,-122.8819225,14.82z/data=!4m6!3m5!1s0x54956c82d1da16cb:0x8a1a6e4a595c53bc!8m2!3d45.3474405!4d-122.8757229!16s%2Fg%2F1tdk9stk?entry=ttu",
   "PhoneNumber":"(503) 625 7705",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":10,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.797143,44.766985 ]
   },
   "properties": {
   "id":10,
   "orchardName":"Queener Farm",
   "City":"Scio",
   "State":"Oregon",
   "Breeds":['Centennial Crab Apples', 'Lodi Apple', 'Belle de Boskoop', 'Honeycrisp', 'Blairmont', 'Blue Pearmain', "Bramley's Seedling", 'Coles Quince Apple', 'Devonshire Crimson Queen', 'Duchess of Oldenburg', 'Empire', 'Erwin Bauer', 'Lubsk Queen', 'Gravenstein', 'Karmijn de Sonnaville', 'Almata', 'Zabergau Reinette', 'Whitney Crab Apple', 'Lady Apples', 'Queen Bee', 'Knobbed Russet', 'Hauer Pippin', 'Baldwin', "Dummelow's Seedling", 'Jonagold'],
   "Address":"40385 Queener Dr, Scio, OR 97374",
   "GMapsLink":"https://www.google.com/maps/place/Queener+Farm/@44.7655144,-122.7981439,14.62z/data=!4m10!1m2!2m1!1sapple+orchards+in+oregon!3m6!1s0x54bff51ca69185d5:0xe52626b2c1585224!8m2!3d44.7666073!4d-122.7968304!15sChhhcHBsZSBvcmNoYXJkcyBpbiBvcmVnb25aGiIYYXBwbGUgb3JjaGFyZHMgaW4gb3JlZ29ukgEEZmFybZoBI0NoWkRTVWhOTUc5blMwVkpRMEZuU1VSRExXWXRTV05CRUFF4AEA!16s%2Fg%2F1tgw4rq7?entry=ttu",
   "PhoneNumber":"(503) 930 8280",
   "Website":"https://www.queenerfarm.com/"
   }
 },
 {
   "type": "Feature",
   "id":11,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -121.623252,45.536512 ]
   },
   "properties": {
   "id":11,
   "orchardName":"Mt View Orchards",
   "City":"Mt Hood",
   "State":"Oregon",
   "Breeds": [],
   "Address":"6670 Trout Creek Ridge Rd, Mt Hood, OR 97041",
   "GMapsLink":"https://www.google.com/maps/place/Mt+View+Orchards/@45.5394122,-121.636731,13.34z/data=!4m6!3m5!1s0x5495fc30fb1d1fdd:0x246bc4700d1f9e63!8m2!3d45.5366083!4d-121.6231454!16s%2Fg%2F12601wlft?entry=ttu",
   "PhoneNumber":"(541) 352 6828",
   "Website":"https://www.mtvieworchards.com/"
   }
 },
 {
   "type": "Feature",
   "id":12,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -121.596412,45.496889 ]
   },
   "properties": {
   "id":12,
   "orchardName":"Kiyokawa Family Orchards",
   "City":"Mt Hood",
   "State":"Oregon",
   "Breeds":['Akane', 'Almata', 'Ambrosia', 'Arkansas Black', "Ashmead's Kernel", 'Blondee', 'Braeburn', 'Black Gilliflower', "Calville Blanc D'Hiver", 'Cameo', 'Cortland', "Cox's Orange Pippin", 'Crimson Crisp', 'Crimson Gold', 'Crimson Topaz', 'Criterion', 'Dandee Red', 'Dolgo Crab', 'Earligold', 'Elstar', 'Empire', 'Evercrisp', 'Fiesta Red Pippin', 'Fuji', 'Gala', 'Ginger Gold', 'Glocken Apfel', 'Golden Delicious', 'Golden Russet', 'Golden Supreme', 'Granny Smith', 'Gravenstein', 'Grimes Golden', 'Hawaii', "Hanner's Jumbo", 'Hokuto', 'Hokotui', 'Honeycrisp', "Hudsen's Golden Gem", 'Idared', 'Initial', 'Jonagold', 'Jonathan', 'Kandil Sinap', 'Kingston Black', 'Lady Apples', 'Liberty', 'Linda Mac', "Little Devil's", 'Lodi', 'Macoun', 'Manchurian Crab', 'McIntosh', 'Melrose', 'Mtn. Rose', 'Mutsu', 'New Town Pippin', 'Northern Spy', 'Orin', 'Ortley', 'Pink Delight', 'Pink Pearl', 'Pristine', "Rall's Janet", 'Red Delicious', 'Redfree', 'Red Golden Delicious', 'Red Rome', 'Red Ruben', 'Ribston Pippin', 'Roxbury Russett', 'Rubinette', 'Ruby Jon', 'RubyMac', 'Sansa', 'Scarlet Surprise', 'Sekai Ichi', 'Smoothie', 'Sonata', 'Spartan', 'Spigold', 'Spitzenberg', 'Splendour', 'Spokane Beauty', 'Summer Pearmain', 'Sweetie', 'Swiss Gourmet', 'Tsugaru', 'Westfield', 'Wickson Crabapples', 'Winesap', 'Winter Banana', 'Wolf River', 'Zabergau Reinette', 'Zestar'],
   "Address":"5625 Hutson Dr, Mt Hood, OR 97041",
   "GMapsLink":"https://www.google.com/maps/place/Kiyokawa+Family+Orchards/@45.4971702,-121.607152,15.06z/data=!4m6!3m5!1s0x5495feddd005b8c3:0xe0a5e731b2ecf273!8m2!3d45.4970125!4d-121.5964673!16s%2Fg%2F1tmgc465?entry=ttu",
   "PhoneNumber":"(541) 352 7115",
   "Website":"https://kiyokawafamilyorchards.com/"
   }
 },
 {
   "type": "Feature",
   "id":13,
   "geometry": {
      "type": "Point",
      "coordinates":  [ -123.137126,44.216505 ]
   },
   "properties": {
   "id":13,
   "orchardName":"Detering Orchards",
   "City":"Harrisburg",
   "State":"Oregon",
   "Breeds":['Gravenstein', 'Early McIntosh', 'Prime Red', 'Golden Supreme', 'Honeycrisp', 'McIntosh', 'Early Fuji', 'Gala', 'Jonagold', 'Ozark Gold', 'Criterion', 'Spartan', 'Golden Delicious', 'Cameo', 'Empire'],
   "Address":"30946 Wyatt Dr, Harrisburg, OR 97446",
   "GMapsLink":"https://www.google.com/maps/place/Detering+Orchards/@44.2159136,-123.149346,14.49z/data=!4m6!3m5!1s0x54c0feab0eeb3041:0x893152c3ddfaade8!8m2!3d44.2169148!4d-123.1364644!16s%2Fg%2F1tc_kwbr?entry=ttu",
   "PhoneNumber":"(541) 995 6341",
   "Website":"https://www.deteringorchards.com/"
   }
 },
 {
   "type": "Feature",
   "id":14,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.561556,47.220799 ]
   },
   "properties": {
   "id":14,
   "orchardName":"Curran Apple Orchards",
   "City":"University Place",
   "State":"Washington",
   "Breeds": [],
   "Address":"3920 Grandview Dr W, University Place, WA 98466",
   "GMapsLink":"https://www.google.com/maps/place/Curran+Apple+Orchard+Park/@47.221403,-122.5641553,16.1z/data=!4m6!3m5!1s0x5491aa5968d3fc8f:0x91f4b46dfacb7100!8m2!3d47.221124!4d-122.5613737!16s%2Fg%2F1tddrxhh?entry=ttu",
   "PhoneNumber":"(253) 460 2530",
   "Website":"http://www.curranappleorchard.com/"
   }
 },
 {
   "type": "Feature",
   "id":15,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.5837397,47.38260464 ]
   },
   "properties": {
   "id":15,
   "orchardName":"Butler's Farm",
   "City":"Gig Harbor",
   "State":"Washington",
   "Breeds": [],
   "Address":"3414 137th St NW, Gig Harbor, WA 98332",
   "GMapsLink":"https://www.google.com/maps/place/Butler's+Farm/@47.3824993,-122.5869154,17z/data=!3m1!4b1!4m6!3m5!1s0x54904dbd6a276717:0xd6be4d0301acbb8f!8m2!3d47.3824957!4d-122.5843405!16s%2Fg%2F11c1qxb29d?entry=ttu",
   "PhoneNumber":"(253) 241 9594",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":16,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.767207,48.00998246 ]
   },
   "properties": {
   "id":16,
   "orchardName":"Finnriver Farm",
   "City":"Chimacum",
   "State":"Washington",
   "Breeds": [],
   "Address":"124 Center Rd, Chimacum, WA 98325",
   "GMapsLink":"https://www.google.com/maps/place/Finnriver+Farm+%26+Cidery/@48.0099734,-122.7752561,15.66z/data=!4m6!3m5!1s0x548fe7b8359c5467:0x190528c8652a166b!8m2!3d48.0097371!4d-122.7694043!16s%2Fg%2F1trcg3n4?entry=ttu",
   "PhoneNumber":"(360) 339 8478",
   "Website":"https://www.finnriver.com/"
   }
 },
 {
   "type": "Feature",
   "id":17,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.9421051,44.62929024 ]
   },
   "properties": {
   "id":17,
   "orchardName":"Aldair's Orchards",
   "City":"Albany",
   "State":"Oregon",
   "Breeds": [],
   "Address":"36452 OR-226, Albany, OR 97322",
   "GMapsLink":"https://www.google.com/maps/place/Adair's+Orchards/@44.6291719,-122.9453559,17z/data=!3m1!4b1!4m6!3m5!1s0x54c07272a9399e87:0x5be0c263cf384fbd!8m2!3d44.6291681!4d-122.942781!16s%2Fg%2F113jf75wl?entry=ttu",
   "PhoneNumber":"(541) 928 6606",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":18,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -121.5695688,45.55002796 ]
   },
   "properties": {
   "id":18,
   "orchardName":"Draper Girls Country Farm",
   "City":"Mt Hood",
   "State":"Oregon",
   "Breeds": [],
   "Address":"6200 OR-35, Mt Hood, OR 97041",
   "GMapsLink":"https://www.google.com/maps/place/Draper+Girls+Country+Farm/@45.5491646,-121.5737284,15.78z/data=!4m6!3m5!1s0x5495fdfaa9e6cc0d:0x5591500b760d48c0!8m2!3d45.5498509!4d-121.5707139!16s%2Fg%2F1vj5zxwz?entry=ttu",
   "PhoneNumber":"(541) 490 8113",
   "Website":"https://www.drapergirlscountryfarm.com/"
   }
 },
 {
   "type": "Feature",
   "id":19,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -123.1651093,44.21929862 ]
   },
   "properties": {
   "id":19,
   "orchardName":"Hentze Family Farm",
   "City":"Junction City",
   "State":"Oregon",
   "Breeds": [],
   "Address":"30045 Hentze Ln, Junction City, OR 97448",
   "GMapsLink":"https://www.google.com/maps/place/Hentze+Family+Farm/@44.2191948,-123.1682528,17z/data=!3m1!4b1!4m6!3m5!1s0x54c0febc60c5b9c1:0x4c41cdfd6b2e7ac6!8m2!3d44.219191!4d-123.1656779!16s%2Fg%2F1ths9255?entry=ttu",
   "PhoneNumber":"(541) 998 8944",
   "Website":"https://hentzefamilyfarm.com/"
   }
 },
 {
   "type": "Feature",
   "id":20,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.9667754,43.96859133 ]
   },
   "properties": {
   "id":20,
   "orchardName":"Tangled Orchards",
   "City":"Creswell",
   "State":"Oregon",
   "Breeds": [],
   "Address":"84822 Cloverdale Rd, Creswell, OR 97426",
   "GMapsLink":"https://www.google.com/maps/place/TANGLED+ORCHARD+FARM/@43.968433,-122.9693825,17z/data=!3m1!4b1!4m6!3m5!1s0x54c12090cea4f6e7:0x7b2435a3d3fe7333!8m2!3d43.9684292!4d-122.9668076!16s%2Fg%2F11c4smxx6_?entry=ttu",
   "PhoneNumber":"(541) 554 1862",
   "Website":"https://www.tangledorchardfarm.com/"
   }
 },
 {
   "type": "Feature",
   "id":21,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.8287492,44.06157945 ]
   },
   "properties": {
   "id":21,
   "orchardName":"Herrick Farms",
   "City":"Springfield",
   "State":"Oregon",
   "Breeds": [],
   "Address":"88088 Millican Rd, Springfield, OR 97478",
   "GMapsLink":"https://www.google.com/maps/place/Herrick+Farms/@44.0615987,-122.8312919,17z/data=!3m1!4b1!4m6!3m5!1s0x54c0dd67bdc4e8fd:0xd4344494f89c99f0!8m2!3d44.0615949!4d-122.828717!16s%2Fg%2F1txc6rxt?entry=ttu",
   "PhoneNumber":"(541) 741 1046",
   "Website":"https://www.herrickfarms.com/home"
   }
 },
 {
   "type": "Feature",
   "id":22,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -123.150364,44.1452668 ]
   },
   "properties": {
   "id":22,
   "orchardName":"Thistledown Farm",
   "City":"Junction City",
   "State":"Oregon",
   "Breeds":['Honeycrisp'],
   "Address":"91455 River Rd, Junction City, OR 97448",
   "GMapsLink":"https://www.google.com/maps/place/Thistledown+Farm/@44.1446964,-123.1547726,16.14z/data=!4m6!3m5!1s0x54c0fd38a6a826cb:0x4ea2c4f84d9711a1!8m2!3d44.1453308!4d-123.150301!16s%2Fg%2F1tgdsw5k?entry=ttu",
   "PhoneNumber":"(541) 689 2019",
   "Website":"https://thistledownfarm.net/"
   }
 },
 {
   "type": "Feature",
   "id":23,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -123.046365,44.10094822 ]
   },
   "properties": {
   "id":23,
   "orchardName":"Johnson Farms",
   "City":"Eugene",
   "State":"Oregon",
   "Breeds": [],
   "Address":"89733 Armitage Rd, Eugene, OR 97408",
   "GMapsLink":"https://www.google.com/maps/place/Johnson+Vegetable+Farms/@44.1004834,-123.0594459,14.33z/data=!4m6!3m5!1s0x54c0e3c8f70e0fe7:0xa03a7671e3a49133!8m2!3d44.1011355!4d-123.0459528!16s%2Fg%2F11b5wsjm9z?entry=ttu",
   "PhoneNumber":"(541) 343 9594",
   "Website":"https://johnsonfarmseugene.com/"
   }
 },
 {
   "type": "Feature",
   "id":24,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.9478045,45.00452777 ]
   },
   "properties": {
   "id":24,
   "orchardName":"E.Z. Orchards",
   "City":"Salem",
   "State":"Oregon",
   "Breeds": [],
   "Address":"5504 Hazelgreen Rd NE, Salem, OR 97305",
   "GMapsLink":"https://www.google.com/maps/place/E.Z.+Orchards+Farm+Market/@45.0046378,-122.9503365,17z/data=!3m1!4b1!4m6!3m5!1s0x54bffd9e9147b7d5:0xe7ba86d3c0794677!8m2!3d45.004634!4d-122.9477616!16s%2Fg%2F1tm0swz5?entry=ttu",
   "PhoneNumber":"(503) 393 1506",
   "Website":"https://www.ezorchards.com/"
   }
 },
 {
   "type": "Feature",
   "id":25,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -123.0870645,45.01738543 ]
   },
   "properties": {
   "id":25,
   "orchardName":"Three Cedars Farm",
   "City":"Salem",
   "State":"Oregon",
   "Breeds": [],
   "Address":"5751 Wallace Rd NW, Salem, OR 97304",
   "GMapsLink":"https://www.google.com/maps/place/Three+Cedars+Farm/@45.0183789,-123.0918766,15.93z/data=!4m6!3m5!1s0x549555ebaa5c1615:0xd01864de2c6b55a1!8m2!3d45.0174548!4d-123.0870243!16s%2Fg%2F11jgh1jnl4?entry=ttu",
   "PhoneNumber":"(909) 851 4877",
   "Website":""
   }
 },
 {
   "type": "Feature",
   "id":26,

   "geometry": {
      "type": "Point",
      "coordinates":  [ -122.8046626,45.12414657 ]
   },
   "properties": {
   "id":26,
   "orchardName":"B&P Hitz Farm",
   "City":"Woodburn",
   "State":"Oregon",
   "Breeds": [],
   "Address":"14070 Wilco Hwy NE #214, Woodburn, OR 97071",
   "GMapsLink":"https://www.google.com/maps/place/B+%26+P+Hitz+Fruit+Farm/@45.1242261,-122.807259,17z/data=!3m1!4b1!4m6!3m5!1s0x54955e5e7dac0279:0x364155c5f05b3d4!8m2!3d45.1242223!4d-122.8046841!16s%2Fg%2F1thq0f6c?entry=ttu",
   "PhoneNumber":"(503) 982 9307",
   "Website":""
   }
 }
]
}


console.log(orchardsData)
//  –––––––––––––––––––––––––––––––––––––––– Global vars, misc  ––––––––––––––––––––––––––––––––––––––––
// Colors from Paletton (light to dark)
// #9F87D6
// #785BBC
// #5D3DA8 -> DATA POINT SHADE
// #46209E
// #321479

var lightPurple = "#9F87D6"
var darkPurple = "#321479"

var panel = document.getElementById('infoPanel')
// var clearButton = document.getElementById('clearPanel')
const appleLayerName = 'orchardsLayer'
const mapboxSourceName = 'orchardsSource'

var baseZoom = 5
var baseCenter = [-120.324262, 45.468905]

var currentID = 0
var currentDiv 
var pointID
// const expandButton = document.getElementById('expandButton')
const orchardContainer = document.getElementById('orchardContainer')

var breedList = []

var breedCount = 0
var filterBreeds = []

var matchFilter = ['all']

var washingtonBorderLayers = ['washingtonBottom', 'washingtonMiddle', 'washingtonTop']
var oregonBorderLayers = ['oregonBottom', 'oregonMiddle', 'oregonTop']

var currentBreeds


// –––––––––––––––––––––––––––––––––––––––– END  ––––––––––––––––––––––––––––––––––––––––


// –––––––––––––––––––––––––––––––––––––––– MAP HANDLERS –––––––––––––––––––––––––––––––––––––––– 
const bounds = [
  [-130.2102074123973, 40.98336280311873], // Southwest coordinates
  [-110.43831658760334, 51.77076348214101] // Northeast coordinates
];

mapboxgl.accessToken = 'pk.eyJ1IjoiZGxlZ2c0OCIsImEiOiJjbHBpcjhucDkwMXp5MmxvdXZ4OTA3ajIzIn0.VrClHW1R9SYZLfcmTzvrLA';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/dlegg48/cluao316i02hz01oigktb1l0s', // Choose your map style
    center: [-120.324262, 45.468905], // Starting position [lng, lat]
    zoom: 5,
    minZoom: 5,
    projection: 'globe',
    maxBounds: bounds  
});
map.getCanvas().style.cursor = 'auto';
map.dragRotate.disable()
map.touchZoomRotate.disableRotation();
map.addControl(new mapboxgl.NavigationControl({}), 'bottom-left');
map.addControl(new mapboxgl.NavigationControl({}), 'top-left');

const mapTitle = document.getElementById("mapTitle")
mapTitle.addEventListener("animationend", function() {
  mapTitle.style.display = "none";
});


map.on('click', 'landcover', () => {
  if ((panel.classList.contains('clicked')) || (currentDiv!=undefined && (currentDiv.classList.contains('clicked')))) {
    clearPanel()
    noHover(currentID)
    clearOrchardContainer()
    d3.selectAll('.selectedOrchard').classed('selectedOrchard', false)
    if (window.innerWidth <= 800){
      d3.select('#infoPanel').classed('hiddenMobileInfoPanel', true)
      d3.select('#infoPanel').classed('showMobileInfoPanel', false)
      d3.select('#closeMobileOrchards').style('display', 'none')
      d3.select('#greyMask').style('display', 'none')
    }
  }
})
map.on('click', 'water', () => {
  if ((panel.classList.contains('clicked')) || (currentDiv!=undefined && (currentDiv.classList.contains('clicked')))) {
    clearPanel()
    noHover(currentID)
    clearOrchardContainer()
    d3.selectAll('.selectedOrchard').classed('selectedOrchard', false)
    if (window.innerWidth <= 800){
      d3.select('#infoPanel').classed('hiddenMobileInfoPanel', true)
      d3.select('#infoPanel').classed('showMobileInfoPanel', false)
      d3.select('#closeMobileOrchards').style('display', 'none')
      d3.select('#greyMask').style('display', 'none')
    }

  }
})
// –––––––––––––––––––––––––––––––––––––––– END –––––––––––––––––––––––––––––––––––––––– 


// –––––––––––––––––––––––––––––––––––––––– loop through orchardsData –––––––––––––––––––––––––––––––––––––––– 
for (var orchardIDX in orchardsData.features){
  currentOrchard = orchardsData.features[orchardIDX]
//   // getting breedList
  try{
    var breeds = currentOrchard.properties.Breeds
    breeds.forEach((appleBreed) => {
        // console.log(appleBreed)
        if(!breedList.includes(appleBreed)){
          // console.log('new apple!')
          breedList.push(appleBreed)
        }
    })
    breedList.sort()
  }
  catch(error){
    console.log('no apple breeds')
  }

}
// –––––––––––––––––––––––––––––––––––––––– END –––––––––––––––––––––––––––––––––––––––– 

// mobile version
if (window.innerWidth <= 800){
  d3.select('#orchardContainer').classed('mobileOrchard', true)
  d3.select('#filterTab').classed('mobileFilterTab', true)
  d3.select('#infoPanel').classed('hiddenMobileInfoPanel', true)
  d3.select('#listContent').classed('hideMobileListContent', true)
}

// medium containers
if(window.innerWidth <= 1000 && window.innerWidth > 800){
  d3.select('#infoPanel').classed('mediumInfoPanel', true)
}


// –––––––––––––––––––––––––––––––––––––––– START MAP.LOAD ––––––––––––––––––––––––––––––––––––––––
map.on('load', () => {
  // console.log(breedList)

  updateOrchards(load=1)

  map.addSource('orchardsSource', {
    "type": 'geojson',
    'data': orchardsData
    
  })
  
  map.addLayer({
    'id': 'orchardsLayer',
    'type': 'circle',
    'source': 'orchardsSource',
    'paint': {
        'circle-radius': [
          'interpolate', ['linear'], ['zoom'],
          5, 5, 
          9, 12
        ],
        'circle-stroke-width': 2,
        'circle-color': '#5d3da8',
        'circle-stroke-color': 'white',
    }
  });
  
  // setting paint property of circles to be dependent on feature-state (if hovered or not)
  map.setPaintProperty(appleLayerName, 'circle-color', [
    'case',
    ['boolean', ['feature-state', 'hover'], false],
    '#F7E922',
    '#5D3DA8'
  ]);

  // on hover of circle point
  map.on('mouseenter', appleLayerName, (e) => {
    // e is the data point and its features -> e.features for geojson object
    var id = e.features[0].properties.id
    console.log('id =' ,id)
    console.log('e =' , e)
    map.getCanvas().style.cursor = 'pointer';

    if ( !panel.classList.contains('clicked')) {
      console.log('at hover cond')
      // set feature state of circle to hovered
      currentID = id
      yesHover(currentID)
      setInfoPanel(e)
    }
  })

  // leaving circle point on hover
  map.on('mouseleave', appleLayerName, (e) => {
    // e is the data point and its features -> e.features for geojson object    
    map.getCanvas().style.cursor = 'auto';

    if (!panel.classList.contains('clicked')) {
      noHover(currentID)    
      panel.innerHTML = ''
    }
  })

  // loop through breedList
  for(var breed of breedList){
    // console.log(breed)
    var divContent = document.createElement('div')
    // divContent.id = 
    divContent.classList.add('breedItem')  
    divContent.innerHTML = `
      <label class="container">
        <input type="checkbox">
        <span class="checkBox"></span>
        <p class=breedName>${breed}</p>
      </label>
    `

    document.getElementById('breedContent').appendChild(divContent)

  }


  document.querySelectorAll('.breedItem input[type="checkbox"]').forEach(function(checkbox) {
    checkbox.addEventListener('change', function() {
        // console.log('clicked');
        const label = checkbox.closest('label');
        var breedName = label.querySelector('.breedName').textContent
        if(this.checked){
          // console.log('checked!')
          addBreed(breedName)
        } else if (!this.checked){
          // console.log('unchecked')
          deleteBreed(breedName)
        }
    });
  });
  
}); 
// –––––––––––––––––––––––––––––––––––––––– END MAP.LOAD ––––––––––––––––––––––––––––––––––––––––
  

// –––––––––––––––––––––––––––––––––––––––– Clicking a point ––––––––––––––––––––––––––––––––––––––––
map.on('click', appleLayerName, (e) => {
  // CLEAR OLD HIGHLIGHT FIRST
  noHover(currentID)
  var id = e.features[0].properties.id
  panel.classList.add('clicked')
  // clearButton.style.display='block'
  
  setInfoPanel(e)
  currentID=id
  yesHover(currentID)
  if(window.innerWidth <= 800){
    d3.select('#infoPanel').classed('hiddenMobileInfoPanel', false)
    d3.select('#infoPanel').classed('showMobileInfoPanel', true)
    d3.select('#closeMobileOrchards').style('display', 'block')
    d3.select('#greyMask').style('display', 'block')
  }
})
// –––––––––––––––––––––––––––––––––––––––– END ––––––––––––––––––––––––––––––––––––––––






// ––––––––––––––––––––––––––––––––––––––––  Function Time –––––––––––––––––––––––––––––––––––––––– 
// sets TRUE hover feature state of circle
function yesHover(pointID){
  // console.log('yesHover()',pointID)
  map.setFeatureState(
    { source: 'orchardsSource', id: pointID},
    { hover: true }
  );
}
// sets FALSE hover feature state of cicrle
function noHover(pointID){
  // console.log(pointID)
  map.setFeatureState(
    { source: 'orchardsSource', id: pointID},
    { hover: false }
  );
}

// sets the information in the top right info panel.
function setInfoPanel(point, idx=0){
  console.log('setInfoPanel()', point)
  const city = point.features[idx].properties.City;
  const state = point.features[idx].properties.State;
  const orchardName = point.features[idx].properties.orchardName;
  const orchardAddress = point.features[idx].properties.Address
  const orchardGMaps = point.features[idx].properties.GMapsLink
  const phone = point.features[idx].properties.PhoneNumber
  const breeds = point.features[idx].properties.Breeds
  console.log(breeds)
  var htmlBreeds = breeds.toString().replace('[', '').replace(']', '').replaceAll('"', '').replaceAll(',', ', ')
  if(htmlBreeds === ''){
    htmlBreeds = 'No breed data!'
  }
  currentBreeds = htmlBreeds
  // console.log('currentBreeds at setPanel()', currentBreeds)
  panel.innerHTML = `
    <h1 class=panelName>${orchardName}</h1>
    <p class=panelText>
    Address: <a class="infoAddress" href=${orchardGMaps} target="_blank">${orchardAddress}</a><br><br>
    Phone Number: ${phone}<br><br>
    </p>
    <div class=htmlBreeds onclick="showBreedList()">
    Breeds: ${htmlBreeds}
    </div>
  `;

}

// clears the information in the top right info panel, and the highlighted circle
function clearPanel(){
  noHover(currentID)
  panel.classList.remove('clicked')
  panel.innerHTML=""
  // clearButton.style.display='none'
  if(currentDiv){
    currentDiv.classList.remove('clicked')
    currentDiv.style.backgroundColor = "#785BBC"
  }
}

// clears panel and then highlights the circle that the sidebar selection is
function containerClick(orchard){
  console.log('containerClick()', orchard)
  // clear highlight of previous click
  if(!(currentDiv==undefined)){
    console.log('div undef')
    if(currentDiv.style.backgroundColor=="rgb(159, 135, 214)"){
      d3.selectAll('.selectedOrchard').classed('selectedOrchard', false)
      // currentDiv.style.backgroundColor = "#785BBC"
      currentDiv.classList.remove('clicked')
      // console.log(pointID)
      noHover(pointID)
      clearPanel()
    }
  }
  if(panel.classList.contains('clicked')){
    console.log('NEW STUFF')
    clearPanel()
  }

  currentDiv = orchard
  var orchardName = orchard.id.slice(4,).replaceAll('_', ' ')

  // new point logic here -> update pointId with pointID = function(orchard name)
  pointID = getOrchardIdx(orchardName)

  console.log('POINT ID =', pointID)
  currentID=pointID
  currentDiv.classList.add('clicked')

  // if panel does not have clicked class onto it
  if(!panel.classList.contains('clicked')){
    console.log(pointID-1)
    panel.classList.add('clicked')
    // clearButton.style.display='block'
    currentDiv.style.backgroundColor = lightPurple
    yesHover(pointID)
    setInfoPanel(orchardsData, (pointID))
  }

  d3.select(orchard).classed('selectedOrchard', true)

}

// on click of land, water, or exit button clear the side bar highlight and panel
function clearOrchardContainer(){
  console.log('clearOrchardContainer')
  noHover(currentID)
  panel.classList.remove('clicked')
  if(currentDiv){
    currentDiv.style.backgroundColor = "#785BBC"
  }
  d3.selectAll('.selectedOrchard').classed('selectedOrchard', false)

}

function collapseMobileOrchard(){
  d3.select('#oregonButton').style('display', 'none')
  d3.select('#washingtonButton').style('display', 'none')
  d3.select('#breedFilter').style('display', 'none')
  d3.select('filterTab').classed('mobileFilterTab', false)
  d3.select('#filterTab').classed('mobileFilterTabCollapsed', true)
  d3.select('#orchardContainer').classed('mobileOrchard', false)
  d3.select('#orchardContainer').classed('collapsedOrchardContainer', true)
}

function expandMobileOrchard(){
  d3.select('#oregonButton').style('display', 'block')
  d3.select('#washingtonButton').style('display', 'block')
  d3.select('#breedFilter').style('display', 'block')
  d3.select('filterTab').classed('mobileFilterTab', true)
  d3.select('#filterTab').classed('mobileFilterTabCollapsed', false)
  d3.select('#orchardContainer').classed('mobileOrchard', true)
  d3.select('#orchardContainer').classed('collapsedOrchardContainer', false)
}

// expands div
function changeOrchardContainerSize(){
  // mobile handler
  if(window.innerWidth <= 800){
    console.log('mobile time!')
    d3.select('#mobileOrchardGrouped').style('display', 'block')
    d3.select('#mobileOrchardGrouped').style('z-index', '10')

    d3.select('#greyMask').style('display', 'block')
    d3.select('#closeMobileOrchards').style('display', 'block')
  } else  { // desktop handler
    console.log('desktop handler height', orchardContainer.style.height)
      // this expands the div
      if(window.getComputedStyle(orchardContainer).height === '64px'){
        console.log('expand container desktop')
        if(window.innerHeight <= 600 ){
          orchardContainer.style.height = '50%'
        }
        else{
          orchardContainer.style.height = '75%'
        }
      } else if (orchardContainer.style.height === '75%'){ // shrink the div
        console.log('shrink container desktop')
        orchardContainer.style.height = '4em'
    }
  }
}

// handles reset button functions
function resetButton(){
  clearOrchardContainer()
  clearPanel()
  clearBreeds()
  clearBorders()
  matchFilter = ['all']
  map.setFilter(appleLayerName, null)
  d3.select('#washingtonButton').classed('lightBackground', false)
  d3.select('#oregonButton').classed('lightBackground', false)
  d3.select('#washingtonButton').style('border-style', 'outset')
  d3.select('#oregonButton').style('border-style', 'outset')
  d3.selectAll('.oregon').style('display', 'block')
  d3.selectAll('.washington').style('display', 'block')
  document.getElementById("washImage").src="img/washOutline.png"
  document.getElementById("oregonImage").src="img/oregonOutline.png"
  d3.select('#oregonDark').style('display', 'none')
  d3.select('#washDark').style('display', 'none')
  updateOrchards()
}

//handles oregon and washington buttons
function oregonFilter(){
  console.log('oregonFilter()')

  if(breedCount!=0){
    console.log('no!')
    clearOrchardContainer()
    clearPanel()
    clearBorders()
    d3.select('#washingtonButton').classed('lightBackground', false)
    d3.select('#oregonButton').classed('lightBackground', false)
    d3.select('#washingtonButton').style('border-style', 'outset')
    d3.select('#oregonButton').style('border-style', 'outset')
    d3.selectAll('.oregon').style('display', 'block')
    d3.selectAll('.washington').style('display', 'block')
    document.getElementById("washImage").src="img/washOutline.png"
    document.getElementById("oregonImage").src="img/oregonOutline.png"
    d3.select('#oregonDark').style('display', 'none')
    d3.select('#washDark').style('display', 'none')

  } else {
    // resetButton()
    clearOrchardContainer()
    clearPanel()
    clearBreeds()
    clearBorders()
    matchFilter = ['all']
    map.setFilter(appleLayerName, null)
    d3.select('#washingtonButton').classed('lightBackground', false)
    d3.select('#oregonButton').classed('lightBackground', false)
    d3.select('#washingtonButton').style('border-style', 'outset')
    d3.select('#oregonButton').style('border-style', 'outset')
    d3.selectAll('.oregon').style('display', 'block')
    d3.selectAll('.washington').style('display', 'block')
    document.getElementById("washImage").src="img/washOutline.png"
    document.getElementById("oregonImage").src="img/oregonOutline.png"
    d3.select('#oregonDark').style('display', 'none')
    d3.select('#washDark').style('display', 'none')
  }

  colorBorder('Oregon')


  for(var item of matchFilter){
    if(item.toString() == '==,get,State,Washington'){
        var idx = matchFilter.indexOf(item)
        matchFilter.splice(idx, 1)
    }
  }

  matchFilter.push(['==', ['get', 'State'], 'Oregon'])
  map.setFilter(appleLayerName, matchFilter)
  updateOrchards()

  d3.select('#washingtonButton').classed('lightBackground', false)
  d3.select('#oregonButton').classed('lightBackground', true)
  d3.select('#oregonButton').style('border-style', 'inset')
  d3.select('#washingtonButton').style('border-style', 'outset')
  d3.selectAll('.washington').style('display', 'none')
  document.getElementById("oregonImage").src="img/oregonFilled.png"
  d3.select('#oregonDark').style('display', 'inline')

}

function colorBorder(state){
  if(state == 'Washington'){
    washingtonBorderLayers.map( (layer) => 
      map.setPaintProperty(
        layer, 
        'line-color', 
        '#5D3DA8'
      )
    );
    map.moveLayer('washingtonBottom')
    map.moveLayer('washingtonMiddle')
    map.moveLayer('washingtonTop')

  } else if (state == 'Oregon'){
    oregonBorderLayers.map((layer) => 
      map.setPaintProperty(
        layer, 
        'line-color', 
        '#5D3DA8'
      )
    );
    map.moveLayer('oregonBottom')
    map.moveLayer('oregonMiddle')
    map.moveLayer('oregonTop')

  }
}
function washingtonFilter(){
  console.log('washingtonFilter()')
  if(breedCount!=0){
    console.log('no!')
    clearOrchardContainer()
    clearPanel()
    clearBorders()
    d3.select('#washingtonButton').classed('lightBackground', false)
    d3.select('#oregonButton').classed('lightBackground', false)
    d3.select('#washingtonButton').style('border-style', 'outset')
    d3.select('#oregonButton').style('border-style', 'outset')
    d3.selectAll('.oregon').style('display', 'block')
    d3.selectAll('.washington').style('display', 'block')
    document.getElementById("washImage").src="img/washOutline.png"
    document.getElementById("oregonImage").src="img/oregonOutline.png"
    d3.select('#oregonDark').style('display', 'none')
    d3.select('#washDark').style('display', 'none')
  
  } else {
    // resetButton()
    clearOrchardContainer()
    clearPanel()
    clearBreeds()
    clearBorders()
    matchFilter = ['all']
    map.setFilter(appleLayerName, null)
    d3.select('#washingtonButton').classed('lightBackground', false)
    d3.select('#oregonButton').classed('lightBackground', false)
    d3.select('#washingtonButton').style('border-style', 'outset')
    d3.select('#oregonButton').style('border-style', 'outset')
    d3.selectAll('.oregon').style('display', 'block')
    d3.selectAll('.washington').style('display', 'block')
    document.getElementById("washImage").src="img/washOutline.png"
    document.getElementById("oregonImage").src="img/oregonOutline.png"
    d3.select('#oregonDark').style('display', 'none')
    d3.select('#washDark').style('display', 'none')
  
  }

  for(var item of matchFilter){
    console.log(item.toString())
    if(item.toString() == '==,get,State,Oregon'){
        console.log('hereaklser')
        var idx = matchFilter.indexOf(item)
        matchFilter.splice(idx, 1)
    }
  }
  colorBorder('Washington')  

  matchFilter.push(['==', ['get', 'State'], 'Washington'])
  // console.log(matchFilter)
  map.setFilter(appleLayerName, matchFilter)
  updateOrchards()

  d3.select('#washingtonButton').classed('lightBackground', true)
  d3.select('#oregonButton').classed('lightBackground', false)
  d3.select('#washingtonButton').style('border-style', 'inset')
  d3.select('#oregonButton').style('border-style', 'outset')
  d3.selectAll('.oregon').style('display', 'none')

  document.getElementById("washImage").src="img/washFilled.png"
  d3.select('#washDark').style('display', 'inline')
}

function clearBorders(){
  oregonBorderLayers.map((layer) => 
    map.setPaintProperty(
      layer, 
      'line-color', 
      '#ffffff'
  ));

  washingtonBorderLayers.map((layer) => 
  map.setPaintProperty(
    layer, 
    'line-color', 
    '#ffffff'
  ));
}

function closeBreedList(){
  d3.select('#listContent').style('display', 'none')
  if(!window.innerWidth <= 800){
    d3.select('#greyMask').style('display', 'none')
  }
}

function showBreedList(){
  // d3.select('#breedList').html('')
  if(window.innerWidth <= 800){
    d3.select('#listContent').classed('hideMobileListContent', false)
    d3.select('#listContent').classed('mobileListContent', true)
    d3.select('#infoPanel').style('z-index', '9')
    d3.select('#closeMobileOrchards').style('z-index', '9')
    d3.select('#mobileOrchardGrouped').style('z-index', '9')

  }
  // document.getElementById('breedList').innerHTML = ""
  d3.select('#greyMask').style('display', 'block')
  d3.select('#listContent').style('display', 'block')
  // console.log('currentBreeds at showBreedList()', currentBreeds)
  d3.select('#breedList').html(currentBreeds)

}

function closeHelp(){
  console.log('closeHelp()')
  d3.select('#greyMask').style('display', 'none')
  d3.select('#howTo').style('display', 'none')
  d3.select('#listContent').style('display', 'none')
  // if(breedCount === 0){
  //   // console.log('here', matchFilter)
  //   // console.log('also', filterBreeds)
  // }
  if(d3.select('#infoPanel').classed('showMobileInfoPanel', true)){
    clearPanel()
    d3.select('#infoPanel').classed('showMobileInfoPanel', false)
    d3.select('#infoPanel').classed('hiddenMobileInfoPanel', true)
    d3.select('#infoPanel').style('z-index', '10')
    d3.select('#closeMobileOrchards').style('z-index', '10')
  
  }

  if(!d3.select('#breedSelector').style('display', 'none')){
    d3.select('#breedSelector').style('display', 'none')
  }

  if(!d3.select('#dataViewer').style('display', 'none')){
    d3.select('#dataViewer').style('display', 'none')
  }

  // if(!d3.select('#mobileOrchardGrouped').style('display', 'none')){
  //   console.log('here')
    d3.select('#mobileOrchardGrouped').style('display', 'none')
    d3.select('#closeMobileOrchards').style('display', 'none')
  // }



}

function openHelp(){
  d3.select('#greyMask').style('display', 'block')
  d3.select('#howTo').style('display', 'block')
}

function openBreedSelector(){
  d3.select('#greyMask').style('display', 'block')
  d3.select('#breedSelector').style('display', 'block')
}

function addBreed(breedName){
  breedCount+=1
  document.getElementById('count').innerHTML = breedCount
  filterBreeds.push(breedName)
  console.log(filterBreeds)
}

function deleteBreed(breedName){
  breedCount-=1
  document.getElementById('count').innerHTML = breedCount
  var idx = filterBreeds.indexOf(breedName)
  filterBreeds.splice(idx, 1)
  // console.log(filterBreeds)

}

function applyBreeds(){

  // matchFilter=['any']
  filterBreeds.forEach(breed => {
    matchFilter.push(['in', breed, ['get', 'Breeds']]);
  });
  console.log('filter at applyBreeds()', matchFilter)
  map.setFilter(appleLayerName, matchFilter)
  updateOrchards()
  closeHelp()
}

function clearBreeds(){
  breedCount = 0
  document.getElementById('count').innerHTML = breedCount
  document.querySelectorAll('#breedContent input[type="checkbox"]').forEach(function(checkbox) {
    checkbox.checked = false;
  });
  filterBreeds = []
}

// var oldCenter
// var oldZoom

function updateOrchards(load=0){
  console.log('updateOrchards()')
  document.getElementById('orchardGrouped').innerHTML = null
  document.getElementById('mobileOrchardGrouped').innerHTML = null
  // document.getElementById('mobileOrchardGrouped').innerHTML += `<button id="closeMobileOrchards" class="w3-button" onclick="closeHelp()">Close</button>
  // `
  // oldCenter = map.getCenter()
  // oldZoom = map.getZoom()
  // console.log(oldCenter, oldZoom)

  // map.flyTo({
  //   center: baseCenter, 
  //   zoom: baseZoom
  // })

  // to go off on load immediately
  if(load==1){
    console.log('on load here')
    for(var loadOrchard of orchardsData.features){
        oName = loadOrchard.properties.orchardName
        oState = loadOrchard.properties.State
        oAddress = loadOrchard.properties.Address
        oGMaps = loadOrchard.properties.GMapsLink
        oPhone = loadOrchard.properties.PhoneNumber
        oCity = loadOrchard.properties.City
        var myBreeds = loadOrchard.properties.Breeds
        var htmlBreeds = myBreeds.toString().replace('[', '').replace(']', '').replaceAll('"', '').replaceAll(',', ', ')

        // console.log(mybreeds.toString())
        if(htmlBreeds.toString() === ''){
          // console.log('NO BREEDS')
          htmlBreeds = 'No breed data!'
        }
        // console.log('htmlBreeds', htmlBreeds)
        // var idx = parseInt(orchardIDX)+1
        // divName = "info" + (idx).toString()
        divName = "info"+oName.replaceAll(' ', '_')
        var div = document.createElement('div')
        div.id = divName
        div.classList.add('scrollInfo')
        div.setAttribute("onclick", `containerClick(this)`);
      
        if(oState == 'Washington'){
          div.classList.add('washington')
          div.innerHTML = `
            <h1 class=containerOrchardName><u>${oName}</u></h1>
            <p class=containerOrchardText>
            <span>
            Address: <a class="infoAddress" href=${oGMaps} target="_blank"> ${oAddress} </a><br>
            </span>
            <span>
            Phone Number: ${oPhone}<br>
            </span>
            <span class="containerBreeds" onclick="showBreedList()">
            Breeds: ${htmlBreeds}<br>
            </span>
            </p>
        `;
        } else {
          div.classList.add('oregon')
          div.innerHTML = `
            <h1 class=containerOrchardName><u>${oName}</u></h1>
            <p class=containerOrchardText>
            <span>
            Address: <a class="infoAddress" href=${oGMaps} target="_blank"> ${oAddress} </a><br>
            </span>
            <span>
            Phone Number: ${oPhone}<br>
            </span>
            <span class="containerBreeds" onclick="showBreedList()">
            Breeds: ${htmlBreeds}<br>
            </span>
            </p>
        `;
        }
        document.getElementById('orchardGrouped').appendChild(div)      
    }
    let $el = $('#orchardGrouped').children().clone()
    // console.log('YEAHHHHHHH', $el)
    $('#mobileOrchardGrouped').append($el)
  
  } else {
    setTimeout(function(){    
      for(orchard of map.queryRenderedFeatures()){
        // console.log(orchard)
        if(orchard.layer.id !== "orchardsLayer"){
          break
        } else {
          oName = orchard.properties.orchardName
          oState = orchard.properties.State
          oAddress = orchard.properties.Address
          oGMaps = orchard.properties.GMapsLink
          oPhone = orchard.properties.PhoneNumber
          oCity = orchard.properties.City
          var myBreeds = orchard.properties.Breeds
          var htmlBreeds = myBreeds.toString().replace('[', '').replace(']', '').replaceAll('"', '').replaceAll(',', ', ')

          // console.log(mybreeds.toString())
          if(htmlBreeds.toString() === ''){
            // console.log('NO BREEDS')
            htmlBreeds = 'No breed data!'
          }
          // console.log('htmlBreeds', htmlBreeds)
          // var idx = parseInt(orchardIDX)+1
          // divName = "info" + (idx).toString()
          divName = "info"+oName.replaceAll(' ', '_')
          var div = document.createElement('div')
          div.id = divName
          div.classList.add('scrollInfo')
          div.setAttribute("onclick", `containerClick(this)`);
        
          if(oState == 'Washington'){
            div.classList.add('washington')
            div.innerHTML = `
              <h1 class=containerOrchardName><u>${oName}</u></h1>
              <p class=containerOrchardText>
              <span>
              Address: <a class="infoAddress" href=${oGMaps} target="_blank"> ${oAddress} </a><br>
              </span>
              <span>
              Phone Number: ${oPhone}<br>
              </span>
              <span class="containerBreeds" onclick="showBreedList()">
              Breeds: ${htmlBreeds}<br>
              </span>
              </p>
          `;
          } else {
            div.classList.add('oregon')
            div.innerHTML = `
              <h1 class=containerOrchardName><u>${oName}</u></h1>
              <p class=containerOrchardText>
              <span>
              Address: <a class="infoAddress" href=${oGMaps} target="_blank"> ${oAddress} </a><br>
              </span>
              <span>
              Phone Number: ${oPhone}<br>
              </span>
              <span class="containerBreeds" onclick="showBreedList()">
              Breeds: ${htmlBreeds}<br>
              </span>
              </p>
          `;
          }
          document.getElementById('orchardGrouped').appendChild(div)
        
        }
      }
      let $el = $('#orchardGrouped').children().clone()
      console.log('YEAHHHHHHH', $el)
      $('#mobileOrchardGrouped').append($el)
    },1000)
  }

  // let $el = $('#orchardGrouped').children().clone()
  // console.log('YEAHHHHHHH', $el)
  // $('#mobileOrchardGrouped').append($el)

  
}

var activeOrchards = []

// function exportData(){
//   console.log('exportData()')

//   activeOrchards = []

//   map.flyTo({
//     center: baseCenter, 
//     zoom: baseZoom
//   })

//   setTimeout(function(){
//     for(layer of map.queryRenderedFeatures()){
//       // console.log(layer)
//       if(layer.layer.id === 'orchardsLayer'){
//         activeOrchards.push(layer)
//       }
//       if(layer.layer.id != 'orchardsLayer'){
//         break
//       }
//     }
//   }, 1000)

//   console.log(activeOrchards)
//   console.log(document.getElementById('orchardGrouped'))
//   d3.select('#greyMask').style('display', 'block')
//   d3.select('#dataViewer').style('display', 'block')


//   for(orchard of activeOrchards){
//     var orchardName = orchard.properties.orchardName
//     var orchardAddress = orchard.properties.Address
//     var orchardNumber = orchard.properties.PhoneNumber
//     var orchardBreeds = orchard.properties.Breeds
    
//     var rowHtml = 
//     `
//       <div class="orchardRow">
//         <div>${orchardName}</div>
//         <div>${orchardAddress}</div>
//         <div>${orchardNumber}</div>
//         <div>${orchardBreeds}</div>
//       </div>
//     `
//   }

// }

function getOrchardIdx(name){
  console.log('getOrchardIdx()',name)
  for(var orchard of orchardsData.features){
    // console.log(orchard)
    if(orchard.properties.orchardName == name){
      // console.log('GOT IT at', name)
      var idx = orchard.properties.id
      break
    }
  }
  return idx
}


map.on('zoomend', function() {
  var currentZoom = map.getZoom();
  var currentCenter = map.getCenter()
  console.log('Current zoom level:', currentZoom);

  if((currentZoom > baseZoom) && (currentCenter !== baseCenter)){
    // mobile disable menus
    if(window.innerWidth <= 800){
      collapseMobileOrchard()
      // document.getElementById("homeButton").src="img/homeDark.png";
    } else{ // desktop disable menues
      disableInteraction()
    }
    document.getElementById("homeButton").src="img/home2.png";
    d3.select('#resetButton').style('display', 'none')
  } else{
      // mobile enable menus
      if(window.innerWidth <=800){
        expandMobileOrchard()
      } else { // desktop enable menus
        enableInteraction()
      }
      document.getElementById("homeButton").src="img/homeDark.png";
      d3.select('#resetButton').style('display', 'block')

  }
});

function disableInteraction(){
  d3.selectAll(".intButton").classed('inactiveButton', true)
  document.getElementById("oregonButton").onclick = null;
  document.getElementById("washingtonButton").onclick = null;
  document.getElementById("breedFilter").onclick = null;
  // document.getElementById("exportDataButton").onclick = null;

  // add mobile logic here with screen width on collapsing container
}

function enableInteraction(){
  d3.selectAll(".intButton").classed('inactiveButton', false)
  document.getElementById("oregonButton").onclick = oregonFilter;
  document.getElementById("washingtonButton").onclick = washingtonFilter;
  document.getElementById("breedFilter").onclick = openBreedSelector;
  // document.getElementById("exportDataButton").onclick = exportData;
}

function returnHome(){
  map.flyTo({
    center: baseCenter, 
    zoom: baseZoom
  })
}
